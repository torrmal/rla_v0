<head>
	<title>Database Report</title>
</head>

<template name='report'>
	<h3>Report</h3>
	<button id='loadreport'>Load Report</button>
	<p>Total number of images - <span id="total"></span></p>
	<p>Total number of images tagged - <span id="tagtotal"></span></p>
	<p>Total number of faces - <span id="faces"></span></p>
	<p><b>Gender Distribution</b></p>
	<p>Total number of male faces - <span id="mfaces"></span></p>
	<p>Total number of female faces - <span id="ffaces"></span></p>
	<p><b>Ethnicity Distribution</b></p>
	<p>Total number of white ethnicity - <span id="whiteE"></span></p>
	<p>Total number of dark ethnicity - <span id="darkE"></span></p>
	<p>Total number of black ethnicity - <span id="blackE"></span></p>
	<p>Total number of asian ethnicity - <span id="asianE"></span></p>
	<p>Total number of south asian ethnicity - <span id="sasianE"></span></p>
	<p>Total number of arabic ethnicity - <span id="arabicE"></span></p>
	<p>Total number of unknown ethnicity - <span id="unknownE"></span></p>
	<p><b>Facial Hair Distribution</b></p>
	<p>Total number of males with facial hair - <span id="mfaceHY"></span></p>
	<p>Total number of males with no facial hair - <span id="mfaceHN"></span></p>
	<p><b>Reading Glasses Distribution</b></p>
	<p>Total number of males with reading glasses - <span id="maleReadY"></span></p>
	<p>Total number of males without reading glasses - <span id="maleReadN"></span></p>
	<p>Total number of females with reading glasses - <span id="femaleReadY"></span></p>
	<p>Total number of females without reading glasses - <span id="femaleReadN"></span></p>
	<p><b>Sun Glasses Distribution</b></p>
	<p>Total number of males with sun glasses - <span id="maleSunY"></span></p>
	<p>Total number of males without sun glasses - <span id="maleSunN"></span></p>
	<p>Total number of females with sun glasses - <span id="femaleSunY"></span></p>
	<p>Total number of females without sun glasses - <span id="femaleSunN"></span></p>
	<p><b>Hair Type Distribution</b></p>
	<p>Total number of faces with red hair - <span id="redH"></span></p>
	<p>Total number of faces with blonde hair - <span id="blondeH"></span></p>
	<p>Total number of faces with brown hair - <span id="brownH"></span></p>
	<p>Total number of faces with black hair - <span id="blackH"></span></p>
	<p>Total number of faces with gray hair - <span id="grayH"></span></p>
	<p><b>Hair Style Distribution</b></p>
	<p>Total number of faces with long hair - <span id="longH"></span></p>
	<p>Total number of faces with short hair - <span id="shortH"></span></p>
	<p>Total number of faces with no hair (bald) - <span id="baldH"></span></p>
	<p><b>Hat Distribution</b></p>
	<p>Total number of males with hat - <span id="maleHatY"></span></p>
	<p>Total number of males without hat - <span id="maleHatN"></span></p>
	<p>Total number of females with hat - <span id="femaleHatY"></span></p>
	<p>Total number of females without hat - <span id="femaleHatN"></span></p>
	<script type="text/javascript">
		Nfaces = 0;
		mNfaces = 0;
		fNfaces = 0;

		whiteEth = 0;
		darkEth = 0;
		blackEth = 0;
		asianEth = 0;
		sasianEth = 0;
		arabEth = 0;
		unkEth = 0;

		malefaceHY = 0;
		malefaceHN = 0;

		maleReadY = 0;
		maleReadN = 0;
		femaleReadY = 0;
		femaleReadN = 0;

		maleSunY = 0;
		maleSunN = 0;
		femaleSunY = 0;
		femaleSunN = 0;

		$('#loadreport').click(function(e) {

			metaDataImage.find({'tagged':true}).forEach( function(doc) {

				Nfaces += doc.tags.length;

				doc.tags.forEach( function(entry) {

					mNfaces += ((entry.sex === 'male')?1:0);
					fNfaces += ((entry.sex === 'female')?1:0);

					var tmpEth = entry.ethnicity;
					if( typeof tmpEth !== 'undefined' ) {
						whiteEth += ((tmpEth === 'white')?1:0);
						darkEth += ((tmpEth === 'dark')?1:0);
						blackEth += ((tmpEth === 'black')?1:0);
						asianEth += ((tmpEth === 'asian')?1:0);
						sasianEth += ((tmpEth === 'sasian')?1:0);
						arabEth += ((tmpEth === 'arabic')?1:0);
						unkEth += ((tmpEth === 'unknown')?1:0);
					}

					if( entry.sex === 'male' ) {
						tmp = entry.facehair;
						if( typeof tmp !== 'undefined' ) {
							malefaceHY += ((tmp === 'yes')?1:0);
							malefaceHN += ((tmp === 'no')?1:0);
						}
					}

					tmp = entry.readglasses;
					if( typeof tmp !== 'undefined' ) {
						if( entry.sex === 'male' ) {
							maleReadY += ((tmp === 'yes')?1:0);
							maleReadN += ((tmp === 'no')?1:0);
						}
						if( entry.sex === 'female' ) {
							femaleReadY += ((tmp === 'yes')?1:0);
							femaleReadN += ((tmp === 'no')?1:0);
						}
					}

					tmp = entry.sunglasses;
					if( typeof tmp !== 'undefined' ) {
						if( entry.sex === 'male' ) {
							maleSunY += ((tmp === 'yes')?1:0);
							maleSunN += ((tmp === 'no')?1:0);
						}
						if( entry.sex === 'female' ) {
							femaleSunY += ((tmp === 'yes')?1:0);
							femaleSunN += ((tmp === 'no')?1:0);
						}
					}

				});
			});

			document.getElementById("total").innerHTML=metaDataImage.find().count();
			document.getElementById("tagtotal").innerHTML=metaDataImage.find({'tagged':true}).count();

			document.getElementById("faces").innerHTML=Nfaces;
			document.getElementById("mfaces").innerHTML=mNfaces;
			document.getElementById("ffaces").innerHTML=fNfaces;

			document.getElementById("whiteE").innerHTML=whiteEth;
			document.getElementById("darkE").innerHTML=darkEth;
			document.getElementById("blackE").innerHTML=blackEth;
			document.getElementById("asianE").innerHTML=asianEth;
			document.getElementById("sasianE").innerHTML=sasianEth;
			document.getElementById("arabicE").innerHTML=arabEth;
			document.getElementById("unknownE").innerHTML=unkEth;

			document.getElementById("mfaceHY").innerHTML=malefaceHY;
			document.getElementById("mfaceHN").innerHTML=malefaceHN;

			document.getElementById("maleReadY").innerHTML=maleReadY;
			document.getElementById("maleReadN").innerHTML=maleReadN;
			document.getElementById("femaleReadY").innerHTML=femaleReadY;
			document.getElementById("femaleReadN").innerHTML=femaleReadN;

			document.getElementById("maleSunY").innerHTML=maleSunY;
			document.getElementById("maleSunN").innerHTML=maleSunN;
			document.getElementById("femaleSunY").innerHTML=femaleSunY;
			document.getElementById("femaleSunN").innerHTML=femaleSunN;
		});
	</script>
</template>
